{% extends "base.html" %}

{% block content %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bulma and DataTables CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.9.3/css/bulma.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/dataTables.bulma.min.css">
    <link rel="stylesheet" href="{{url_for('static', filename='/css/style.css')}}" />
</head>

<body>
    <section class="section">
        <div class="container" style="background-color: white;">
            <h1 class="title has-text-centered has-text-primary mb-6" >Top Job Picks</h1>

            <!-- Job Table -->
            <div class="table-container">
                <div class="table-wrapper" style="overflow-x: auto; padding-bottom: 1em;">
                    <table id="jobTable" class="table is-striped is-hoverable is-fullwidth">
                        <thead>
                            <tr>
                                <th>Job Title</th>
                                <th>Company</th>
                                <th>Job Description</th>
                                <th>Department</th>
                                <th>Location(s)</th>
                                <th>Hourly Pay</th>
                                <th>Employee Benefits</th>
                                <th>Review</th>
                                <th>Rating</th>
                                <th>Recommendation</th>
                            </tr>
                            <tr>
                                <!-- Filters Row -->
                                <th><input type="text" class="input is-small" placeholder="Filter Job Title"></th>
                                <th><input type="text" class="input is-small" placeholder="Filter Company"></th>
                                <th><input type="text" class="input is-small" placeholder="Filter Description"></th>
                                <th><input type="text" class="input is-small" placeholder="Filter Department"></th>
                                <th><input type="text" class="input is-small" placeholder="Filter Location"></th>
                                <th><input type="text" class="input is-small" placeholder="Filter Pay"></th>
                                <th><input type="text" class="input is-small" placeholder="Filter Benefits"></th>
                                <th><input type="text" class="input is-small" placeholder="Filter Review"></th>
                                <th><input type="text" class="input is-small" placeholder="Filter Rating"></th>
                                <th><input type="text" class="input is-small" placeholder="Filter Recommendation"></th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for job in jobs %}
                            <tr class="clickable-row" data-href="/view/{{ job.id }}">
                                <td><strong>{{ job.title }}</strong></td>
                                <td><strong>{{ job.company }}</strong></td>
                                <td>{{ job.description }}</td>
                                <td>{{ job.department }}</td>
                                <td>{{ job.locations }}</td>
                                <td>{{ job.hourly_pay }}$</td>
                                <td>{{ job.benefits }}</td>
                                <td>{{ job.review }}</td>
                                <td>{{ job.rating }}/5</td>
                                <td>{{ job.recommendation }}/10</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/dataTables.bulma.min.js"></script>
    
    <script>
        $(document).ready(function () {
            // Initialize DataTable with column filters and sorting enabled
            var table = $('#jobTable').DataTable({
                orderCellsTop: true,
                fixedHeader: true,
                responsive: true,  // Enable responsiveness
                autoWidth: false,
                pageLength: 10,  // Set the number of rows per page (adjust as needed)
                lengthMenu: [5, 10, 25, 50, 100]
            });

            // Apply search functionality to each column filter
            $('#jobTable thead tr:eq(1) th').each(function (i) {
                $('input', this).on('keyup change', function () {
                    if (table.column(i).search() !== this.value) {
                        table.column(i).search(this.value).draw();
                    }
                });
            });

            // Make rows clickable
            $('#jobTable tbody').on('click', 'tr', function () {
                window.location = $(this).data('href');
            });
        });
    </script>
</body>

</html>

{% endblock %}
